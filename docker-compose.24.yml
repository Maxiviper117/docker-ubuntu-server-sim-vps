services:
  vps:
    image: ubuntu24-vps-sim
    container_name: ubuntu24-vps-sim
    build:
      context: .
      dockerfile: Dockerfile.24
    env_file:
      - .env    
    environment:
      - SSH_PUB_KEY=${SSH_PUB_KEY}
    ports:
      - "2222:22"
      - "2375:2375"
      - "8080:80"
      - "8443:443"
    privileged: true
    stdin_open: true
    tty: true
    restart: unless-stopped
    volumes:
      - vps_docker:/var/lib/docker
    # healthcheck:
    #   test: ["CMD-SHELL", "sshd -T >/dev/null"]
    #   interval: 30s
    #   timeout: 5s
    #   retries: 3  

volumes:
  vps_docker:
    driver: local


# to run:
# docker compose -f docker-compose.24.yml up -d